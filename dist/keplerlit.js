!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.KeplerLit=e():t.KeplerLit=e()}(this,()=>(()=>{"use strict";var t={97:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.ColorMap=e.addColorMap=e.colorMapNames=e.createLut=void 0;var o=n(879);e.createLut=function(t,e,n){void 0===n&&(n=1);for(var o=r[t]||r.Rainbow,s=[],a=0,h=0;h<n;++h)o.forEach(function(t){s.push([a+t[0]/n,t[1]])}),a+=1/n;return new i(s,e)},e.colorMapNames=function(){for(var t=[],e=0,n=Object.entries(r);e<n.length;e++){var o=n[e],i=o[0];o[1],t.push(i)}return t},e.addColorMap=function(t,e){r[t]=e};var i=function(){function t(t,e){this.map=[],this.lut=[],this.n=256,this.minV=0,this.maxV=1,this.setColorMap(t,e)}return t.addColorMap=function(t,e){r[t]=e},Object.defineProperty(t.prototype,"mapColors",{get:function(){return this.map},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this.canvas_},enumerable:!1,configurable:!0}),t.prototype.set=function(e){return e instanceof t&&this.copy(e),this},Object.defineProperty(t.prototype,"length",{get:function(){return this.map.length},enumerable:!1,configurable:!0}),t.prototype.setMin=function(t){return this.minV=t,this},t.prototype.setMax=function(t){return this.maxV=t,this},t.prototype.setColorMap=function(t,e){Array.isArray(t)?this.map=t:this.map=r[t]||r.Rainbow,this.n=e||32;var n=1/this.n;this.lut=[];for(var i=0;i<=1;i+=n)for(var s=0;s<this.map.length-1;s++)if(i>=this.map[s][0]&&i<this.map[s+1][0]){var a=this.map[s][0],h=this.map[s+1][0],u=new o.Color(this.map[s][1]),p=new o.Color(this.map[s+1][1]),l=u.lerp(p,(i-a)/(h-a));this.lut.push(l)}return this},t.prototype.copy=function(t){return this.lut=t.lut,this.map=t.map,this.n=t.n,this.minV=t.minV,this.maxV=t.maxV,this},t.prototype.getColor=function(t){t<=this.minV?t=this.minV:t>=this.maxV&&(t=this.maxV),t=(t-this.minV)/(this.maxV-this.minV);var e=Math.round(t*this.n);return e===this.n&&(e-=1),this.lut[e]},t.prototype.createCanvas=function(t,e){void 0===t&&(t=document),void 0===e&&(e=1);var n=t.createElement("canvas");return n.width=e,n.height=this.n,this.updateCanvas(n),n},t.prototype.updateCanvas=function(t){this.canvas_=t;for(var e=t.getContext("2d",{alpha:!1}),n=0,i=1/this.n,r=1;r>=0;r-=i)for(var s=this.map.length-1;s>=0;s--)if(r<this.map[s][0]&&r>=this.map[s-1][0]){var a=this.map[s-1][0],h=this.map[s][0],u=new o.Color(this.map[s-1][1]),p=new o.Color(this.map[s][1]),l=u.lerp(p,(r-a)/(h-a));e.fillStyle="rgb(".concat(Math.round(255*l.r),", ").concat(Math.round(255*l.g),", ").concat(Math.round(255*l.b),")"),e.fillRect(0,n,15,1),n+=1}return t},t}();e.ColorMap=i;var r={Cooltowarm:[[0,3952322],[.2,10206463],[.5,14474460],[.8,16163717],[1,11797542]],Blackbody:[[0,0],[.2,7864320],[.5,15086080],[.8,16776960],[1,16777215]],Grayscale:[[0,0],[.2,4210752],[.5,8355712],[.8,12566463],[1,16777215]],Insar:[[0,327893],[.3,47871],[.5,65478],[.7,16580352],[1,13631488]],InsarBanded:[[0,327893],[.02040816326530612,47871],[.04081632653061224,65478],[.061224489795918366,16580352],[.08163265306122448,13631488],[.1020408163265306,327893],[.12244897959183673,47871],[.14285714285714285,65478],[.16326530612244897,16580352],[.18367346938775508,13631488],[.2040816326530612,327893],[.22448979591836732,47871],[.24489795918367346,65478],[.26530612244897955,16580352],[.2857142857142857,13631488],[.3061224489795918,327893],[.32653061224489793,47871],[.3469387755102041,65478],[.36734693877551017,16580352],[.3877551020408163,13631488],[.4081632653061224,327893],[.42857142857142855,47871],[.44897959183673464,65478],[.4693877551020408,16580352],[.4897959183673469,13631488],[.5102040816326531,327893],[.5306122448979591,47871],[.5510204081632653,65478],[.5714285714285714,16580352],[.5918367346938775,13631488],[.6122448979591836,327893],[.6326530612244897,47871],[.6530612244897959,65478],[.673469387755102,16580352],[.6938775510204082,13631488],[.7142857142857142,327893],[.7346938775510203,47871],[.7551020408163265,65478],[.7755102040816326,16580352],[.7959183673469387,13631488],[.8163265306122448,327893],[.836734693877551,47871],[.8571428571428571,65478],[.8775510204081632,16580352],[.8979591836734693,13631488],[.9183673469387754,327893],[.9387755102040816,47871],[.9591836734693877,65478],[.9795918367346939,16580352],[.9999999999999999,13631488]],Rainbow:[[0,16711680],[.2,16776192],[.4,65286],[.6,65532],[.8,393471],[1,16122111]],Igeoss:[[0,13863],[.1,35387],[.2,6864397],[.3,14081792],[.4,16437248],[.5,16760848],[.6,16756238],[.7,16751366],[.8,16406528],[.9,15204360],[1,8912899]],Stress:[[0,255],[.33,16777215],[.331,51200],[.66,16777215],[.661,16711680],[1,16777215]],Blue_White_Red:[[0,4863],[.5,16777215],[1,16711680]],Blue_Green_Red:[[0,4863],[.25,16777215],[.5,65280],[.275,16777215],[1,16711680]],Spectrum:[[0,16777215],[.1428,16711680],[.2856,16711932],[.4284,393471],[.5712,63231],[.714,65286],[.8568,16776192],[1,16711680]],Default:[[0,786687],[.25,64767],[.5,65292],[.75,16187136],[1,16711680]],Banded:[[0,16774605],[.1666,16750080],[.1667,13565905],[.3333,1077504],[.3334,13952251],[.5,90031],[.5001,15458043],[.6666,12911262],[.6667,16773323],[.8333,8674560],[.8334,16373976],[1,14286848]]}},156:function(t,e,n){var o=this&&this.__createBinding||(Object.create?function(t,e,n,o){void 0===o&&(o=n);var i=Object.getOwnPropertyDescriptor(e,n);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[n]}}),Object.defineProperty(t,o,i)}:function(t,e,n,o){void 0===o&&(o=n),t[o]=e[n]}),i=this&&this.__exportStar||function(t,e){for(var n in t)"default"===n||Object.prototype.hasOwnProperty.call(e,n)||o(e,t,n)};Object.defineProperty(e,"__esModule",{value:!0}),i(n(879),e),i(n(97),e),i(n(185),e),i(n(906),e),i(n(487),e),i(n(859),e)},185:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.fromValuesToColors=e.fromValueToColor=e.scale=e.normalize=e.min=e.max=e.minMax=e.lerp=void 0;var o=n(97);function i(t){for(var e=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,o=t.length,i=0;i<o;++i){var r=t[i];r<e&&(e=r),r>n&&(n=r)}return[e,n]}e.lerp=function(t,e,n){if(t<0||t>1)throw new Error("t must be clamped to the range [0,1]. Got ".concat(t));return(1-t)*e+t*n},e.minMax=i,e.max=function(t){for(var e=Number.NEGATIVE_INFINITY,n=t.length,o=0;o<n;++o){var i=t[o];i>e&&(e=i)}return e},e.min=function(t){for(var e=Number.POSITIVE_INFINITY,n=t.length,o=0;o<n;++o){var i=t[o];i<e&&(e=i)}return e},e.normalize=function(t){var e=i(t);return t.map(function(t){return(t-e[0])/(e[1]-e[0])})},e.scale=function(t,e){return t.map(function(t){return t*e})},e.fromValueToColor=function(t,e){var n=e.min,o=void 0===n?0:n,i=e.max,r=void 0===i?1:i,s=e.lutTable,a=e.defaultColor,h=e.reverse,u=void 0!==h&&h;if(t<0||t>1)throw new Error("value *must% be normalized. Got ".concat(t));var p=u?1-t:t;if(p>=o&&p<=r){var l=s.getColor(p);return[l.r,l.g,l.b]}return[a.r,a.g,a.b]},e.fromValuesToColors=function(t,e){var n=e.defaultColor,r=e.lut,s=e.duplicateLut,a=void 0===s?1:s,h=e.min,u=void 0===h?0:h,p=e.max,l=void 0===p?1:p,c=e.lockLut,f=void 0===c||c,v=e.reverse,d=void 0!==v&&v,m=r instanceof o.ColorMap?r:(0,o.createLut)(r,32,a),g=i(t),_=g[0],y=g[1];f?m.setMin(0).setMax(1):m.setMin(u).setMax(l);var b=new Array(3*t.length).fill(0);return t.forEach(function(t,e){var o=d?(t-y)/(_-y):(t-_)/(y-_);if(o>=u&&o<=l){var i=m.getColor(o);b[3*e]=i.r,b[3*e+1]=i.g,b[3*e+2]=i.b}else b[3*e]=n.r,b[3*e+1]=n.g,b[3*e+2]=n.b}),b}},487:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.createIsoContourLines=void 0;var o=n(879),i=n(97),r=n(747),s=n(185);e.createIsoContourLines=function(t,e,n,a,h){var u=this;if(void 0===t)throw new Error("mesh is undefined");if(void 0===t.getPositions())throw new Error("mesh.positions is undefined");if(void 0===t.getIndices())throw new Error("mesh.indices is undefined");if(void 0===e)throw new Error("attribute is undefined");var p=(0,s.minMax)(e),l=p[0],c=p[1],f=void 0;null==h&&((f=(0,i.createLut)(h,128)).setMin(l),f.setMax(c));var v=new o.Color(a),d=n,m=new r.MarchingTriangles;m.setup(t.getIndices(),[l,c]);for(var g=t.getPositions(),_=[],y=[],b=function(t){return(t-u.vmin_)/(u.vmax_-u.vmin_)},x=0;x<d.length;++x){var w=m.isolines(e,d[x]),C=(0,s.fromValueToColor)(b(d[x]),{min:l,max:c,defaultColor:v,lutTable:f});y.push.apply(y,C);for(var M=0;M<w[0].length;++M)for(var I=0;I<w[0][M].length-2;I+=2){var S=w[0][M][I],V=w[0][M][I+1],A=w[1][M][I/2],z=g.get(S),P=g.get(V),T=z[0],E=z[1],j=z[2],O=P[0],N=P[1],B=P[2];_.push(T+A*(O-T),E+A*(N-E),j+A*(B-j))}}return{positions:_,color:y}}},747:(t,e,n)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.MarchingTriangles=void 0;var o=n(185),i=function(){function t(){this.topo_=[],this.lock_=!1,this.maxVertexIndex_=-1,this._bounds=[]}return t.prototype.setup=function(t,e){this.lock_=!1,this.maxVertexIndex_=-1,this._bounds=e,this.topo_=[];for(var n=0;n<t.array.length;n+=3){var o=t.array[n],i=t.array[n+1],r=t.array[n+2];if(this.topo_.push({i:o,j:i,k:r}),o===i||o===r||i===r)throw new Error("Error in topology while setting up iso-contouring in 'MarchingTriangles.' At index ".concat(n,", got 3 indices (").concat(o,", ").concat(i,", ").concat(r,")"));this.maxVertexIndex_=Math.max(this.maxVertexIndex_,o,i,r)}return this.lock_=!0,!0},t.prototype.isolines=function(t,e){var n=[[]];if(!1===this.lock_)return n;if(t.length<0)return n;void 0===this._bounds&&(this._bounds=(0,o.minMax)(t));for(var i=new Map,h=[],u=[0,0,0],p=new Map(new Map),l=0;l<this.topo_.length;++l){u[0]=this.topo_[l].i,u[1]=this.topo_[l].j,u[2]=this.topo_[l].k;var c=void 0,f=void 0,v=t[u[0]],d=t[u[1]],m=t[u[2]];if(!1!==r(v,d,m,this._bounds[0],this._bounds[1])){c=d>=e?1:0,f=m>=e?1:0;var g=a[v>=e?1:0][c][f];if(g>0&&g<7){i.set(l,g),h[0]=s[g][0],h[1]=s[g][1];for(var _=0;_<2;++_){var y=((O=h[_])+1)%3;O=u[O],y=u[y];var b=Math.min(O,y),x=Math.max(O,y);if(b in p)p.get(b).get(x).push(l);else{var w=new Map;w.set(x,[l]),p.set(b,w)}}}}}for(;!(i.size<=0);){var C=[],M=[],I=i.keys().next().value,S=i.get(I);if(i.delete(i.keys().next().value),!(S<1||S>6)){u[0]=this.topo_[I].i,u[1]=this.topo_[I].j,u[2]=this.topo_[I].k,h[0]=s[S][0],h[1]=s[S][1];var V=[],A=[];for(_=0;_<2;++_)y=((O=h[_])+1)%3,O=u[O],y=u[y],C.push(O),C.push(y),M.push((e-t[O])/(t[y]-t[O])),b=Math.min(O,y),x=Math.max(O,y),0===_?(V[0]=b,V[1]=x):(A[0]=b,A[1]=x);var z=0,P=0;do{for(var T=I;;){var E=[p.get(A[0]).get(A[1])];if(1===E.length)break;T=E[0]+E[1]-T;var j=i.get(T);if(!(j in i))break;for(S=j.second,i.delete(j),u[0]=this.topo_[T].i,u[1]=this.topo_[T].j,u[2]=this.topo_[T].k,h[0]=s[S][0],h[1]=s[S][1],_=0;_<2;++_){var O;if(y=((O=h[_])+1)%3,O=u[O],y=u[y],b=Math.min(O,y),x=Math.max(O,y),b!==A[0]||x!==A[1]){C.push(O),C.push(y),M.push((e-t[O])/(t[y]-t[O])),A[0]=b,A[1]=x;break}}}if(A[0]===V[0]&&A[1]===V[1]){C.push(C[0]),C.push(C[1]),M.push(M[0]),z=M.length;break}0===P&&(A[0]=V[0],A[1]=V[1],z=M.length),++P}while(P<2);if(z===M.length)n[0].push(C),void 0===n[1]?n[1]=[M]:n[1].push(M);else{for(var N=[],B=[],k=C.length-1;k>=2*z;--k)N.push(C[k]);for(k=M.length-1;k>=z;--k)B.push(1-M[k]);for(k=0;k<2*z;++k)N.push(C[k]);for(k=0;k<z;++k)B.push(M[k]);n[0].push(N),n[1].push(B)}}}return n},t}();function r(t,e,n,o,i){function r(t,e,n){return t>=e&&t<=n}return r(t,o,i)&&r(e,o,i)&&r(n,o,i)}e.MarchingTriangles=i;var s=[[-1,-1],[1,2],[0,1],[2,0],[2,0],[0,1],[1,2],[-1,-1]],a=[[[0,1],[2,3]],[[4,5],[6,7]]]},859:function(t,e){var n,o=this&&this.__extends||(n=function(t,e){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},n(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__assign||function(){return i=Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},i.apply(this,arguments)};Object.defineProperty(e,"__esModule",{value:!0}),e.Uint32BufferAttribute=e.Uint16BufferAttribute=e.Float32BufferAttribute=e.BufferGeometry=e.BufferAttribute=void 0;var r=function(){function t(t,e,n){void 0===n&&(n=!1),this.array=t,this.itemSize=e,this.count=t.length/e,this.normalized=n,this.usage=35044,this.updateRange={offset:0,count:-1},this.version=0,this.needsUpdate=!1}return t.prototype.set=function(t,e){if(e.length!==this.itemSize)throw new Error("Expected ".concat(this.itemSize," values, got ").concat(e.length));if(t<0||t>=this.count)throw new Error("Index ".concat(t," out of range [0, ").concat(this.count-1,"]"));for(var n=t*this.itemSize,o=0;o<this.itemSize;o++)this.array[n+o]=e[o];return this.needsUpdate=!0,this},t.prototype.get=function(t){if(t<0||t>=this.count)throw new Error("Index ".concat(t," out of range [0, ").concat(this.count-1,"]"));for(var e=t*this.itemSize,n=[],o=0;o<this.itemSize;o++)n.push(this.array[e+o]);return n},t.prototype.getX=function(t){if(t<0||t>=this.count)throw new Error("Index ".concat(t," out of range [0, ").concat(this.count-1,"]"));return this.array[t*this.itemSize]},t.prototype.getY=function(t){if(this.itemSize<2)throw new Error("Item size is ".concat(this.itemSize,", cannot get Y component"));return this.array[t*this.itemSize+1]},t.prototype.getZ=function(t){if(this.itemSize<3)throw new Error("Item size is ".concat(this.itemSize,", cannot get Z component"));return this.array[t*this.itemSize+2]},t.prototype.setComponent=function(t,e,n){if(t<0||t>=this.count)throw new Error("Index ".concat(t," out of range [0, ").concat(this.count-1,"]"));if(e<0||e>=this.itemSize)throw new Error("Component ".concat(e," out of range [0, ").concat(this.itemSize-1,"]"));return this.array[t*this.itemSize+e]=n,this.needsUpdate=!0,this},t.prototype.getComponent=function(t,e){if(t<0||t>=this.count)throw new Error("Index ".concat(t," out of range [0, ").concat(this.count-1,"]"));if(e<0||e>=this.itemSize)throw new Error("Component ".concat(e," out of range [0, ").concat(this.itemSize-1,"]"));return this.array[t*this.itemSize+e]},t.prototype.copy=function(t){return this.array=t.array.slice(),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.updateRange=i({},t.updateRange),this.version=t.version,this.needsUpdate=t.needsUpdate,this},t.prototype.copyAt=function(t,e,n){if(this.itemSize!==e.itemSize)throw new Error("ItemSize mismatch: ".concat(this.itemSize," vs ").concat(e.itemSize));var o=e.get(n);return this.set(t,o),this},t.prototype.clone=function(){return new t(new(0,this.array.constructor)(this.array),this.itemSize,this.normalized)},t.prototype.setUsage=function(t){return this.usage=t,this},t.prototype.getByteLength=function(){return this.array.byteLength},t.prototype.forEach=function(t){for(var e=0;e<this.count;e++)t(this.get(e),e);return this},t}();e.BufferAttribute=r;var s=function(){function t(t,e){this.attributes={},this.positions=null,this.indices=null,t&&(this.positions=t),e&&(this.indices=e)}return t.prototype.setPositions=function(t){return this.positions=t,this},t.prototype.getPositions=function(){return this.positions},t.prototype.setIndices=function(t){return this.indices=t,this},t.prototype.getIndices=function(){return this.indices},t.prototype.setAttribute=function(t,e){return this.attributes[t]=e,this},t.prototype.getAttribute=function(t){return this.attributes[t]},t.prototype.computeVertexNormals=function(){if(!this.positions)return console.warn("Cannot compute vertex normals: no position attribute found"),this;var t=this.positions,e=t.count,n=new Float32Array(3*e),o=this.getAttribute("normal");o?(n.fill(0),o.array=n):(o=new a(n,3),this.setAttribute("normal",o));var i=[0,0,0],r=[0,0,0],s=[0,0,0],h=[0,0,0],u=[0,0,0],p=[0,0,0],l=function(t,e,n){n[0]=t[1]*e[2]-t[2]*e[1],n[1]=t[2]*e[0]-t[0]*e[2],n[2]=t[0]*e[1]-t[1]*e[0]},c=function(t,e,n){n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2]},f=function(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]};if(this.indices)for(var v=this.indices.array,d=v.length/3,m=0;m<d;m++){var g=v[3*m],_=v[3*m+1],y=v[3*m+2];i[0]=t.getComponent(g,0),i[1]=t.getComponent(g,1),i[2]=t.getComponent(g,2),r[0]=t.getComponent(_,0),r[1]=t.getComponent(_,1),r[2]=t.getComponent(_,2),s[0]=t.getComponent(y,0),s[1]=t.getComponent(y,1),s[2]=t.getComponent(y,2),c(r,i,h),c(s,i,u),l(h,u,p);var b=[n[3*g],n[3*g+1],n[3*g+2]],x=[n[3*_],n[3*_+1],n[3*_+2]],w=[n[3*y],n[3*y+1],n[3*y+2]];f(b,p),f(x,p),f(w,p),n[3*g]=b[0],n[3*g+1]=b[1],n[3*g+2]=b[2],n[3*_]=x[0],n[3*_+1]=x[1],n[3*_+2]=x[2],n[3*y]=w[0],n[3*y+1]=w[1],n[3*y+2]=w[2]}else for(d=e/3,m=0;m<d;m++)g=3*m,_=3*m+1,y=3*m+2,i[0]=t.getComponent(g,0),i[1]=t.getComponent(g,1),i[2]=t.getComponent(g,2),r[0]=t.getComponent(_,0),r[1]=t.getComponent(_,1),r[2]=t.getComponent(_,2),s[0]=t.getComponent(y,0),s[1]=t.getComponent(y,1),s[2]=t.getComponent(y,2),c(r,i,h),c(s,i,u),l(h,u,p),n[3*g]=p[0],n[3*g+1]=p[1],n[3*g+2]=p[2],n[3*_]=p[0],n[3*_+1]=p[1],n[3*_+2]=p[2],n[3*y]=p[0],n[3*y+1]=p[1],n[3*y+2]=p[2];for(m=0;m<e;m++){var C=n[3*m],M=n[3*m+1],I=n[3*m+2],S=Math.sqrt(C*C+M*M+I*I);S>0?(n[3*m]=C/S,n[3*m+1]=M/S,n[3*m+2]=I/S):(n[3*m]=0,n[3*m+1]=1,n[3*m+2]=0)}return o.needsUpdate=!0,this},t}();e.BufferGeometry=s;var a=function(t){function e(e,n,o){void 0===o&&(o=!1);var i=e instanceof Float32Array?e:new Float32Array(e);return t.call(this,i,n,o)||this}return o(e,t),e}(r);e.Float32BufferAttribute=a;var h=function(t){function e(e,n,o){void 0===o&&(o=!1);var i=e instanceof Uint16Array?e:new Uint16Array(e);return t.call(this,i,n,o)||this}return o(e,t),e}(r);e.Uint16BufferAttribute=h;var u=function(t){function e(e,n,o){void 0===o&&(o=!1);var i=e instanceof Uint32Array?e:new Uint32Array(e);return t.call(this,i,n,o)||this}return o(e,t),e}(r);e.Uint32BufferAttribute=u},879:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.Color=void 0;var n=function(){function t(e){if(e)if(Array.isArray(e)){if(3!==e.length)throw new Error("RGB array must have exactly 3 elements");this.r=e[0],this.g=e[1],this.b=e[2]}else if("string"==typeof e){if(!/^#([0-9A-F]{3}|[0-9A-F]{6})$/i.test(e))throw new Error("Invalid hex color format");this.setHex(e)}else if("number"==typeof e)this.setHex(t.toHexString(e));else if("number"==typeof e)this.setHex(t.toHexString(e));else{if("object"!=typeof e)throw new Error("Invalid color format. Must be an array of 3 numbers, a hex string, or a Color instance. Got ".concat(e));this.r=e.r,this.g=e.g,this.b=e.b}else this.r=0,this.g=0,this.b=0}return t.prototype.lerp=function(e,n){if(n<0||n>1)throw new Error("Interpolation factor t must be between 0 and 1");if(!(e instanceof t))throw new Error("Argument must be an instance of Color");return new t({r:this.r+(e.r-this.r)*n,g:this.g+(e.g-this.g)*n,b:this.b+(e.b-this.b)*n})},t.toHexString=function(t){return"#"+(16777215&t).toString(16).padStart(6,"0").toUpperCase()},t.prototype.toHex=function(){var t=Math.round(255*this.r).toString(16).padStart(2,"0"),e=Math.round(255*this.g).toString(16).padStart(2,"0"),n=Math.round(255*this.b).toString(16).padStart(2,"0");return"#".concat(t).concat(e).concat(n)},t.prototype.setHex=function(t){if(6!==(t=t.replace("#","")).length)throw new Error("Invalid hex color format");return this.r=parseInt(t.substring(0,2),16)/255,this.g=parseInt(t.substring(2,4),16)/255,this.b=parseInt(t.substring(4,6),16)/255,this},t}();e.Color=n},906:function(t,e,n){var o=this&&this.__spreadArray||function(t,e,n){if(n||2===arguments.length)for(var o,i=0,r=e.length;i<r;i++)!o&&i in e||(o||(o=Array.prototype.slice.call(e,0,i)),o[i]=e[i]);return t.concat(o||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.IsoContoursFilled=void 0;var i=n(879),r=n(97),s=n(185),a=function(){function t(t,e,n){this.attr=void 0,this.nodes_=void 0,this.segment_list_=[],this.vmin_=0,this.vmax_=1,this.color_=new i.Color("#000000"),this.lutTable_=(0,r.createLut)("Insar",128),this.position_=[],this.index_=[],this.colors_=[],this.isoValues_=[],this.normals_=[],this.nnormals_=void 0,this.color_=new i.Color("#000000"),this.lutTable_=(0,r.createLut)(t,e),this.lutTable_.setMin(0),this.lutTable_.setMax(1),this.isoValues_=n}return Object.defineProperty(t.prototype,"position",{get:function(){return this.position_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this.index_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.colors_},enumerable:!1,configurable:!0}),t.prototype.run=function(t,e,n,o){void 0===n&&(n=void 0),void 0===o&&(o=void 0),this.attr=t;var i=(0,s.minMax)(this.attr);if(this.vmin_=void 0!==n?n:i[0],this.vmax_=void 0!==o?o:i[1],0===this.isoValues_.length)return{position:[],index:[],color:[],normal:[]};var r=e.getIndices().array;this.nodes_=e.getPositions(),this.nnormals_=e.getAttribute("normal"),void 0===this.nnormals_&&(e.computeVertexNormals(),this.nnormals_=e.getAttribute("normal"));for(var a=0;a<r.length;a+=3)this.classify(r[a],r[a+1],r[a+2]);return{position:this.position_,index:this.index_,color:this.colors_,normal:this.normals_}},t.prototype.normalizeAttr=function(t){return(t-this.vmin_)/(this.vmax_-this.vmin_)},t.prototype.getNode=function(t){return this.nodes_.get(t)},t.prototype.getNormal=function(t){return this.nnormals_.get(t)},t.prototype.getAttr=function(t){return this.attr[t]},t.prototype.classify=function(t,e,n){var o,i,r,s,a,h,p=new u;p.v1=this.getAttr(t),p.p1=this.getNode(t),p.n1=this.getNormal(t),p.v2=this.getAttr(e),p.p2=this.getNode(e),p.n2=this.getNormal(e),p.v3=this.getAttr(n),p.p3=this.getNode(n),p.n3=this.getNormal(n);var l=0,c=0,f=0;if(p.v1<=p.v2&&p.v1<=p.v3)s=p.p1,l=p.v1,o=p.n1,p.v2<=p.v3?(a=p.p2,h=p.p3,c=p.v2,f=p.v3,i=p.n2,r=p.n3):(a=p.p3,h=p.p2,c=p.v3,f=p.v2,i=p.n3,r=p.n2,p.reversed=!0);else if(p.v2<=p.v1&&p.v2<=p.v3)s=p.p2,l=p.v2,o=p.n2,p.v1<=p.v3?(a=p.p1,h=p.p3,c=p.v1,f=p.v3,i=p.n1,r=p.n3,p.reversed=!0):(a=p.p3,h=p.p1,c=p.v3,f=p.v1,i=p.n3,r=p.n1);else{if(!(p.v3<=p.v1&&p.v3<=p.v2))return;s=p.p3,l=p.v3,o=p.n3,p.v1<=p.v2?(a=p.p1,h=p.p2,c=p.v1,f=p.v2,i=p.n1,r=p.n2):(a=p.p2,h=p.p1,c=p.v2,f=p.v1,i=p.n2,r=p.n1,p.reversed=!0)}p.p1=s,p.p2=a,p.p3=h,p.v1=l,p.v2=c,p.v3=f,p.n1=o,p.n2=i,p.n3=r,this.createSegmentList(p),this.createPolygons(p),e=n},t.prototype.createSegmentList=function(t){this.segment_list_=[],t.notIntersectedPolygonValue=this.vmin_;for(var e=0,n=this.isoValues_;e<n.length;e++){var o=n[e];if(o>=t.v3)break;o>t.v1?this.addSegment(o,t):t.notIntersectedPolygonValue=o}},t.prototype.addSegment=function(t,e){var n=new h;n.iso=t;var o=e.v1,i=e.v2,r=e.v3,s=e.p1,a=e.p2,u=e.p3;if(t<e.v2){var p=f(o,i,t),l=f(o,r,t);n.p1=c(s,a,p),n.p2=c(s,u,l),n.n1=c(e.n1,e.n2,p),n.n2=c(e.n1,e.n3,l)}else p=f(i,r,t),l=f(o,r,t),n.p1=c(a,u,p),n.p2=c(s,u,l),n.n1=c(e.n2,e.n3,p),n.n2=c(e.n1,e.n3,l);this.segment_list_.push(n)},t.prototype.createPolygons=function(t){if(!((t.v1<this.vmin_||t.v1>this.vmax_)&&(t.v2<this.vmin_||t.v2>this.vmax_)&&(t.v3<this.vmin_||t.v3>this.vmax_))){var e=function(t){return[-t[0],-t[1],-t[2]]},n=!1;if(t.reversed){if(0===this.segment_list_.length)return void this.addTri(t.p1,t.p3,t.p2,t.n1,t.n3,t.n2,t.notIntersectedPolygonValue);(i=p(this.segment_list_)).iso<t.v2?this.addTri(t.p1,i.p2,i.p1,t.n1,i.n2,i.n1,t.notIntersectedPolygonValue):(n=!0,this.addQuad(t.p1,i.p2,i.p1,t.p2,t.n1,i.n2,i.n1,t.n2,t.notIntersectedPolygonValue));for(var o=1;o<this.segment_list_.length;++o)(r=this.segment_list_[o]).iso<t.v2?this.addQuad(i.p1,r.p1,r.p2,i.p2,e(i.n1),e(r.n1),e(r.n2),e(i.n2),i.iso):n?this.addQuad(i.p1,i.p2,r.p2,r.p1,i.n1,i.n2,r.n2,r.n1,i.iso):(n=!0,this.addPoly(t.p2,i.p1,i.p2,r.p2,r.p1,t.n2,i.n1,i.n2,r.n2,r.n1,i.iso)),i=r;i=l(this.segment_list_),n?this.addTri(i.p1,i.p2,t.p3,i.n1,i.n2,t.n3,i.iso):this.addQuad(t.p2,i.p1,i.p2,t.p3,t.n2,i.n1,i.n2,t.n3,i.iso)}else{if(0===this.segment_list_.length)return void this.addTri(t.p1,t.p2,t.p3,t.n1,t.n2,t.n3,t.notIntersectedPolygonValue);var i;for((i=p(this.segment_list_)).iso<t.v2?this.addTri(t.p1,i.p1,i.p2,t.n1,i.n1,i.n2,t.notIntersectedPolygonValue):(n=!0,this.addQuad(t.p1,t.p2,i.p1,i.p2,t.n1,t.n2,i.n1,i.n2,t.notIntersectedPolygonValue)),o=1;o<this.segment_list_.length;++o){var r;(r=this.segment_list_[o]).iso<t.v2||n?this.addQuad(i.p1,r.p1,r.p2,i.p2,i.n1,r.n1,r.n2,i.n2,i.iso):(n=!0,this.addPoly(t.p2,r.p1,r.p2,i.p2,i.p1,t.n2,r.n1,r.n2,i.n2,i.n1,i.iso)),i=r}i=l(this.segment_list_),n?this.addTri(i.p1,t.p3,i.p2,i.n1,t.n3,i.n2,i.iso):this.addQuad(t.p2,t.p3,i.p2,i.p1,t.n2,t.n3,i.n2,i.n1,i.iso)}}},t.prototype.addTri=function(t,e,n,i,r,a,h){var u,p,l;if(!(h<this.vmin_||h>this.vmax_)){var c=(0,s.fromValueToColor)(this.normalizeAttr(h),{defaultColor:this.color_,lutTable:this.lutTable_}),f=this.position_.length/3;(u=this.position_).push.apply(u,o(o(o([],t,!1),e,!1),n,!1)),this.index_.push(f,f+1,f+2),(p=this.colors_).push.apply(p,o(o(o([],c,!1),c,!1),c,!1)),(l=this.normals_).push.apply(l,o(o(o([],i,!1),r,!1),a,!1))}},t.prototype.addQuad=function(t,e,n,i,r,a,h,u,p){var l,c,f;if(!(p<this.vmin_||p>this.vmax_)){var v=(0,s.fromValueToColor)(this.normalizeAttr(p),{defaultColor:this.color_,lutTable:this.lutTable_}),d=this.position_.length/3;(l=this.position_).push.apply(l,o(o(o(o([],t,!1),e,!1),n,!1),i,!1)),this.index_.push(d,d+1,d+2,d,d+2,d+3),(c=this.colors_).push.apply(c,o(o(o(o([],v,!1),v,!1),v,!1),v,!1)),(f=this.normals_).push.apply(f,o(o(o(o([],r,!1),a,!1),h,!1),u,!1))}},t.prototype.addPoly=function(t,e,n,i,r,a,h,u,p,l,c){var f,v,d;if(!(c<this.vmin_||c>this.vmax_)){var m=(0,s.fromValueToColor)(this.normalizeAttr(c),{defaultColor:this.color_,lutTable:this.lutTable_}),g=this.position_.length/3;(f=this.position_).push.apply(f,o(o(o(o(o([],t,!1),e,!1),n,!1),i,!1),r,!1)),this.index_.push(g,g+1,g+2,g,g+2,g+3,g,g+3,g+4),(v=this.colors_).push.apply(v,o(o(o(o(o([],m,!1),m,!1),m,!1),m,!1),m,!1)),(d=this.normals_).push.apply(d,o(o(o(o(o([],a,!1),h,!1),u,!1),p,!1),l,!1))}},t}();e.IsoContoursFilled=a;var h=function(){this.p1=[0,0,0],this.p2=[0,0,0],this.n1=[0,0,1],this.n2=[0,0,1],this.iso=0},u=function(){this.reversed=!1,this.p1=[0,0,0],this.p2=[0,0,0],this.p3=[0,0,0],this.n1=[1,0,0],this.n2=[1,0,0],this.n3=[1,0,0],this.v1=0,this.v2=0,this.v3=0,this.notIntersectedPolygonValue=0},p=function(t){return t[0]},l=function(t){return t[t.length-1]};function c(t,e,n){var o=1-n;return[n*t[0]+o*e[0],n*t[1]+o*e[1],n*t[2]+o*e[2]]}function f(t,e,n){return 1-Math.abs(n-t)/Math.abs(e-t)}}},e={};return function n(o){var i=e[o];if(void 0!==i)return i.exports;var r=e[o]={exports:{}};return t[o].call(r.exports,r,r.exports,n),r.exports}(156)})());